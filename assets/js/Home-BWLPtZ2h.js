import{j as e}from"./index-D-hE1YEg.js";import{r as t,L as s}from"./react-vendor-3UH2GquY.js";const a="jashn_media_cache";function n(){const[n,i]=t.useState([]),[o,l]=t.useState(!0),[c,d]=t.useState(null);t.useEffect(()=>{m()},[]);const m=t.useCallback(()=>{return e=this,t=null,s=function*(){const e="https://media.hereco.xyz/jashnevents/",t=e+"?restype=container&comp=list";try{const r=localStorage.getItem(a);if(r)try{const{data:e,timestamp:t}=JSON.parse(r);if(Date.now()-t<3e5&&Array.isArray(e)&&e.length>0)return i(e),void l(!1)}catch(s){localStorage.removeItem(a)}const o=new AbortController,c=setTimeout(()=>o.abort(),1e4),d=yield fetch(t,{signal:o.signal,cache:"default"});if(clearTimeout(c),!d.ok)throw new Error(`Failed to fetch: ${d.status} ${d.statusText}`);const m=yield d.text(),h=(new DOMParser).parseFromString(m,"application/xml");if(h.querySelector("parsererror"))throw new Error("Unable to parse blob list");const p=h.getElementsByTagName("Blob");if(0===p.length)return i([]),void l(!1);const g=Array.from(p).map(t=>{const s=t.getElementsByTagName("Name")[0].textContent,a=s.split(".").pop().toLowerCase();return{name:s,url:e+s,ext:a,type:["jpg","jpeg","png","webp","gif"].includes(a)?"image":"video"}}),u=g.filter(e=>"image"===e.type),y=g.filter(e=>"video"===e.type),x=[...u,...y];try{localStorage.setItem(a,JSON.stringify({data:x,timestamp:Date.now()}))}catch(n){}i(x),l(!1)}catch(r){try{const e=localStorage.getItem(a);if(e){const{data:t}=JSON.parse(e);if(Array.isArray(t)&&t.length>0)return i(t),d("Using cached data (network error)"),void l(!1)}}catch(o){}d("AbortError"===r.name?"Request timeout":r.message),l(!1)}},new Promise((a,n)=>{var r=e=>{try{o(s.next(e))}catch(t){n(t)}},i=e=>{try{o(s.throw(e))}catch(t){n(t)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(r,i);o((s=s.apply(e,t)).next())});var e,t,s},[]);return e.jsxs("main",{className:"main",children:[e.jsx("section",{className:"hero-section",children:e.jsxs("div",{className:"profile-container",children:[e.jsx("img",{className:"profile",src:"https://media.hereco.xyz/assets/550869990_17885489733365604_3186628821431398796_n.jpg",alt:"Jashn Events"}),e.jsx("h1",{children:"Jashn Events"}),e.jsxs("p",{children:["Creating Unforgettable Moments â€¢ Owned by ",e.jsx("strong",{children:"Animesh Sahu"})]}),e.jsx(s,{to:"/booking",className:"book-now-btn",children:"ðŸ“… Book Your Event"})]})}),e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"section-header-center",children:[e.jsx("h2",{className:"section-title",children:"Our Event Gallery"}),e.jsx("p",{children:"Capturing the magic of every celebration"})]}),o&&e.jsxs("div",{className:"loading-spinner",children:[e.jsx("div",{className:"spinner-wrapper",children:e.jsx("img",{src:"https://media.hereco.xyz/assets/550869990_17885489733365604_3186628821431398796_n.jpg",alt:"Loading",className:"spinner-image"})}),e.jsx("p",{children:"Loading amazing moments..."})]}),c&&e.jsx("div",{className:"error-message",children:e.jsxs("p",{children:["Unable to load media: ",c]})}),!o&&!c&&0===n.length&&e.jsx("div",{className:"empty-message",children:e.jsx("p",{children:"No media files found."})}),!o&&!c&&n.length>0&&e.jsx("div",{className:"media-grid",id:"gallery",children:n.map((t,s)=>e.jsx(r,{item:t,index:s},s))})]})]})}function r({item:s,index:a}){const[n,r]=t.useState(!1),[i,o]=t.useState(!1),l=t.useRef(null),[c,d]=t.useState(a<9);return t.useEffect(()=>{if(c)return;const e=l.current;if(!e)return;const t=new IntersectionObserver(e=>{e[0].isIntersecting&&(d(!0),t.disconnect())},{rootMargin:"300px",threshold:.01});return t.observe(e),()=>t.disconnect()},[c]),e.jsxs("div",{ref:l,className:`media-item ${"video"===s.type?"video-item":""} ${i?"playing":""}`,style:{animationDelay:a<9?"0s":"0.1s"},children:[!n&&e.jsx("div",{className:"media-placeholder"}),"image"===s.type?e.jsx("img",{src:c?s.url:"",alt:"Event photo",className:n?"loaded":"loading",onLoad:()=>r(!0),onError:()=>r(!0),loading:a<6?"eager":"lazy",decoding:"async",style:{display:c?"block":"none"}}):e.jsx("video",{src:c?s.url:"",controls:!0,preload:"metadata",playsInline:!0,className:n?"loaded":"loading",onLoadedMetadata:()=>r(!0),onPlay:()=>o(!0),onPause:()=>o(!1),style:{display:c?"block":"none"}})]})}export{n as default};
