var e=Object.defineProperty,s=Object.defineProperties,n=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,l=(s,n,t)=>n in s?e(s,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[n]=t,r=(e,s)=>{for(var n in s||(s={}))a.call(s,n)&&l(e,n,s[n]);if(t)for(var n of t(s))i.call(s,n)&&l(e,n,s[n]);return e},c=(e,t)=>s(e,n(t)),d=(e,s,n)=>new Promise((t,a)=>{var i=e=>{try{r(n.next(e))}catch(s){a(s)}},l=e=>{try{r(n.throw(e))}catch(s){a(s)}},r=e=>e.done?t(e.value):Promise.resolve(e.value).then(i,l);r((n=n.apply(e,s)).next())});import{j as o}from"./index-D-hE1YEg.js";import{d as h,r as m}from"./react-vendor-3UH2GquY.js";const u=()=>{const e=h(),[s,n]=m.useState([]),[t,a]=m.useState([]),[i,l]=m.useState(!0),[u,j]=m.useState({total:0,pending:0,confirmed:0,thisMonth:0}),[g,x]=m.useState({status:"all",eventType:"all",search:""}),[p,v]=m.useState({type:"",message:""}),[y,N]=m.useState(null),f="https://bookingapi.hereco.xyz/api/booking",b="jashn_admin_2024_secure_key_"+btoa("jashn-events-admin");m.useEffect(()=>{const s=localStorage.getItem("adminUser");if(!s)return void e("/admin-login");try{const e=JSON.parse(s);N(e)}catch(t){return void e("/admin-login")}k();const n=setInterval(k,3e4);return()=>clearInterval(n)},[e]),m.useEffect(()=>{C()},[g,s]);const k=()=>d(void 0,null,function*(){try{const e=yield fetch(f,{headers:{"X-API-Key":b}}),s=yield e.json();if(!s.success)throw new Error("Failed to load bookings");n(s.bookings),w(s.bookings)}catch(e){S("error","Failed to load bookings: "+e.message)}finally{l(!1)}}),w=e=>{const s=e.length,n=e.filter(e=>"pending"===e.status).length,t=e.filter(e=>"confirmed"===e.status).length,a=new Date,i=e.filter(e=>{const s=new Date(e.createdAt);return s.getMonth()===a.getMonth()&&s.getFullYear()===a.getFullYear()}).length;j({total:s,pending:n,confirmed:t,thisMonth:i})},C=()=>{let e=[...s];if("all"!==g.status&&(e=e.filter(e=>e.status===g.status)),"all"!==g.eventType&&(e=e.filter(e=>e.eventType===g.eventType)),g.search){const s=g.search.toLowerCase();e=e.filter(e=>e.name.toLowerCase().includes(s)||e.email.toLowerCase().includes(s)||e.phone.includes(s))}a(e)},S=(e,s)=>{v({type:e,message:s}),setTimeout(()=>v({type:"",message:""}),5e3)},E=(e,s)=>d(void 0,null,function*(){if(confirm(`Are you sure you want to change status to ${s.toUpperCase()}?`))try{const n=yield fetch(`${f}/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json","X-API-Key":b},body:JSON.stringify({status:s})}),t=yield n.json();if(!n.ok||!t.success)throw new Error(t.error||"Failed to update status");S("success","Status updated successfully!"),k()}catch(n){S("error","Failed to update status: "+n.message)}}),D=e=>new Date(e).toLocaleString("en-IN",{timeZone:"Asia/Kolkata",dateStyle:"medium",timeStyle:"short"});return i?o.jsxs("div",{className:"admin-loading",children:[o.jsx("div",{className:"spinner"}),o.jsx("p",{children:"Loading bookings..."})]}):o.jsxs("div",{className:"admin-wrapper",children:[o.jsxs("div",{className:"admin-header",children:[o.jsx("div",{className:"header-left",children:o.jsxs("div",{className:"admin-logo",children:[o.jsx("h1",{children:"üéâ Jashn Events"}),o.jsx("span",{className:"admin-badge",children:"Admin Panel"})]})}),o.jsxs("div",{className:"header-right",children:[o.jsx("span",{className:"user-email",children:(null==y?void 0:y.email)||"admin@jashn.com"}),o.jsx("button",{className:"logout-btn",onClick:()=>{confirm("Are you sure you want to logout?")&&(localStorage.removeItem("adminUser"),e("/admin-login"))},children:"üö™ Logout"})]})]}),o.jsxs("div",{className:"admin-container",children:[p.message&&o.jsxs("div",{className:`notification ${p.type}`,children:["success"===p.type?"‚úì":"‚úó"," ",p.message]}),o.jsxs("div",{className:"stats-grid",children:[o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-icon",children:"üìä"}),o.jsxs("div",{className:"stat-info",children:[o.jsx("h3",{children:"Total Bookings"}),o.jsx("div",{className:"stat-number",children:u.total})]})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-icon pending",children:"‚è≥"}),o.jsxs("div",{className:"stat-info",children:[o.jsx("h3",{children:"Pending"}),o.jsx("div",{className:"stat-number",children:u.pending})]})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-icon confirmed",children:"‚úì"}),o.jsxs("div",{className:"stat-info",children:[o.jsx("h3",{children:"Confirmed"}),o.jsx("div",{className:"stat-number",children:u.confirmed})]})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-icon",children:"üìÖ"}),o.jsxs("div",{className:"stat-info",children:[o.jsx("h3",{children:"This Month"}),o.jsx("div",{className:"stat-number",children:u.thisMonth})]})]})]}),o.jsxs("div",{className:"filters-bar",children:[o.jsxs("select",{value:g.status,onChange:e=>x(c(r({},g),{status:e.target.value})),children:[o.jsx("option",{value:"all",children:"All Status"}),o.jsx("option",{value:"pending",children:"Pending"}),o.jsx("option",{value:"confirmed",children:"Confirmed"}),o.jsx("option",{value:"cancelled",children:"Cancelled"})]}),o.jsxs("select",{value:g.eventType,onChange:e=>x(c(r({},g),{eventType:e.target.value})),children:[o.jsx("option",{value:"all",children:"All Event Types"}),o.jsx("option",{value:"wedding",children:"Wedding"}),o.jsx("option",{value:"birthday",children:"Birthday"}),o.jsx("option",{value:"corporate",children:"Corporate"}),o.jsx("option",{value:"anniversary",children:"Anniversary"}),o.jsx("option",{value:"engagement",children:"Engagement"}),o.jsx("option",{value:"other",children:"Other"})]}),o.jsx("input",{type:"text",placeholder:"Search by name, email, phone...",value:g.search,onChange:e=>x(c(r({},g),{search:e.target.value}))}),o.jsx("button",{className:"refresh-btn",onClick:k,children:"üîÑ Refresh"})]}),o.jsxs("div",{className:"bookings-section",children:[o.jsxs("div",{className:"section-header",children:[o.jsx("h2",{children:"Recent Bookings"}),o.jsxs("span",{className:"booking-count",children:[t.length," bookings"]})]}),o.jsx("div",{className:"bookings-grid",children:0===t.length?o.jsxs("div",{className:"empty-state",children:[o.jsx("h3",{children:"üì≠ No Bookings Found"}),o.jsx("p",{children:"No bookings match your filters"})]}):t.map(e=>{return o.jsxs("div",{className:"booking-card",children:[o.jsxs("div",{className:"booking-header",children:[o.jsxs("div",{children:[o.jsx("div",{className:"booking-title",children:e.eventType.charAt(0).toUpperCase()+e.eventType.slice(1)}),o.jsxs("div",{className:"booking-id",children:["ID: ",e._id]})]}),o.jsx("span",{className:`status-badge status-${e.status}`,children:e.status.toUpperCase()})]}),o.jsxs("div",{className:"quick-stats",children:[o.jsxs("span",{className:"quick-stat",children:["üìÖ ",new Date(e.eventDate).toLocaleDateString("en-IN",{month:"short",day:"numeric",year:"numeric"})]}),e.guests&&o.jsxs("span",{className:"quick-stat",children:["üë• ",e.guests," guests"]}),e.budget&&o.jsxs("span",{className:"quick-stat",children:["üí∞ ",e.budget]})]}),o.jsxs("div",{className:"booking-details",children:[o.jsxs("div",{className:"detail-group",children:[o.jsx("h4",{children:"Contact Person"}),o.jsx("p",{children:e.name})]}),o.jsxs("div",{className:"detail-group",children:[o.jsx("h4",{children:"Email"}),o.jsx("p",{children:o.jsx("a",{href:`mailto:${e.email}`,children:e.email})})]}),o.jsxs("div",{className:"detail-group",children:[o.jsx("h4",{children:"Phone"}),o.jsx("p",{children:o.jsx("a",{href:`tel:${e.phone}`,children:e.phone})})]}),o.jsxs("div",{className:"detail-group",children:[o.jsx("h4",{children:"Event Date"}),o.jsx("p",{children:(s=e.eventDate,new Date(s).toLocaleDateString("en-IN",{year:"numeric",month:"long",day:"numeric"}))})]}),e.guests&&o.jsxs("div",{className:"detail-group",children:[o.jsx("h4",{children:"Expected Guests"}),o.jsx("p",{children:e.guests})]}),e.budget&&o.jsxs("div",{className:"detail-group",children:[o.jsx("h4",{children:"Budget Range"}),o.jsx("p",{children:e.budget})]}),e.venue&&o.jsxs("div",{className:"detail-group",children:[o.jsx("h4",{children:"Venue/Location"}),o.jsx("p",{children:e.venue})]})]}),e.message&&o.jsxs("div",{className:"message-box",children:[o.jsx("h4",{children:"Additional Details"}),o.jsx("p",{children:e.message})]}),o.jsxs("div",{className:"timestamp",children:["Submitted: ",D(e.createdAt)]}),o.jsxs("div",{className:"status-actions",children:[o.jsx("button",{className:"status-btn confirm",onClick:()=>E(e._id,"confirmed"),disabled:"confirmed"===e.status,children:"‚úì Confirm"}),o.jsx("button",{className:"status-btn cancel",onClick:()=>E(e._id,"cancelled"),disabled:"cancelled"===e.status,children:"‚úó Cancel"}),o.jsx("button",{className:"status-btn pending",onClick:()=>E(e._id,"pending"),disabled:"pending"===e.status,children:"‚ü≥ Pending"}),o.jsx("button",{className:"status-btn delete",onClick:()=>{return s=e._id,n=e.name,d(void 0,null,function*(){if(confirm(`‚ö†Ô∏è Are you sure you want to DELETE this booking?\n\nCustomer: ${n}\n\nThis action cannot be undone!`)&&confirm("Final confirmation: Delete this booking permanently?"))try{const e=yield fetch(`${f}/${s}`,{method:"DELETE",headers:{"X-API-Key":b}}),n=yield e.json();if(!e.ok||!n.success)throw new Error(n.error||"Failed to delete booking");S("success","Booking deleted successfully!"),k()}catch(e){S("error","Failed to delete booking: "+e.message)}});var s,n},children:"üóëÔ∏è Delete"})]})]},e._id);var s})})]})]})]})};export{u as default};
